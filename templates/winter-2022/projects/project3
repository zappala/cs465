<!DOCTYPE html>
<html lang="en">
  <head>
    <title>CS 465 Computer Security</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8"/>
<link rel="shortcut icon" href="/static/img/favicon.ico">
<link href="https://fonts.googleapis.com/css?family=Lora:700|Work+Sans:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="/static/css/app.css" rel="stylesheet">
  </head>
  <body>
    <div class="container-fluid header">
      <div class="row">
	<div class="col-md-7 brand">
	  <a href="/">CS 465 Computer Security</a>
	</div>
	<div class="col-md-5 affiliation">
	  <a href="https://www.byu.edu">BYU</a> | <a
	  href="https://cs.byu.edu">Computer Science</a>
	</div>
	</div>
	<div class="row">
	<div class="col-sm">
	  <h1>
Winter 2022
</h1>
	  <h4>
Section 1: MWF, 11:00am - 11:50am, TMCB 120
</h4>
	</div>
	</div>
	</div>

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
  <a class="navbar-brand" href="#">Navbar</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
	<span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
	<ul class="navbar-nav mr-auto">
	  







<li class="nav-item ">
<a class="nav-link" href=/winter-2022/ >Syllabus</a>
</li>




<li class="nav-item ">
<a class="nav-link" href=/winter-2022/schedule >Schedule</a>
</li>




<li class="nav-item ">
<a class="nav-link" href=/winter-2022/lectures >Lecture Material</a>
</li>
<li class="nav-item dropdown">
  <a class="nav-link dropdown-toggle" href="/homework" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Homework</a>
  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
    



<a class="dropdown-item" href=/winter-2022/homework/homework1 >Homework #1</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework2 >Homework #2</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework3 >Homework #3</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework4 >Homework #4</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework5 >Homework #5</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework6 >Homework #6</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework7 >Homework #7</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework8 >Homework #8</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework9 >Homework #9</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework10 >Homework #10</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework11 >Homework #11</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework12 >Homework #12</a>
    



<a class="dropdown-item" href=/winter-2022/homework/homework13 >Homework #13</a>
</div>
</li>
<li class="nav-item dropdown">
  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Projects</a>
  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
    



<a class="dropdown-item" href=/winter-2022/projects/project1 >Project #1: AES</a>
    



<a class="dropdown-item" href=/winter-2022/projects/project2 >Project #2: Hash Attack</a>
    



<a class="dropdown-item" href=/winter-2022/projects/project3 >Project #3: MAC Attack</a>
    



<a class="dropdown-item" href=/winter-2022/projects/project4 >Project #4: Diffie-Hellman</a>
    



<a class="dropdown-item" href=/winter-2022/projects/project5 >Project #5: RSA</a>
    



<a class="dropdown-item" href=/winter-2022/projects/project6 >Project #6: TLS</a>
    



<a class="dropdown-item" href=/winter-2022/projects/project7 >Project #7: Password Cracking</a>
    



<a class="dropdown-item" href=/winter-2022/projects/project8 >Project #8: Extracting Secrets</a>
    



<a class="dropdown-item" href=/winter-2022/projects/project9 >Project #9: Buffer Overflow</a>
    



<a class="dropdown-item" href=/winter-2022/projects/project10 >Project #10: S/MIME and PGP</a>
    



<a class="dropdown-item" href=/winter-2022/projects/project11 >Project #11: CTF Extra Credit</a>
</div>
</li>
<li class="nav-item dropdown">
  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Help</a>
  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
    





<a class="dropdown-item" href=/winter-2022/help/instructor >Instructor and TAs</a>
    





<a class="dropdown-item" href=/winter-2022/help/officehours >Office Hours</a>
    





<a class="dropdown-item" href=/winter-2022/help/study-guide-midterm1 >Midterm 1 Study Guide</a>
    





<a class="dropdown-item" href=/winter-2022/help/study-guide-midterm2 >Midterm 2 Study Guide</a>
    





<a class="dropdown-item" href=/winter-2022/help/slack >Class Slack Channel</a>
    </div>
    </li>
</ul>


	</ul>
      </div>
    </div>
    </nav>

    <div id="page" class="white">
    <div class="container-fluid">
    <div class="row">
          <div class="col-sm">

	    

<h1>Project 3: MAC Attack</h1>
<h2>Objectives</h2>
<ul>
<li>
<p>Understand the Secure Hash Algorithm</p>
</li>
<li>
<p>Understand Message Authentication Code vs. One-way Hash</p>
</li>
<li>
<p>Understand how an implementation can expose vulnerabilities</p>
</li>
<li>
<p>Understand how HMAC (the government standard) thwarts a message
  extension attack</p>
</li>
</ul>
<h2>Requirements</h2>
<ul>
<li>
<p>Optional but recommended: Implement SHA-1 using the <a href="/static/pubs/fips180-3_final.pdf">FIPS 180-3
  specification</a>
  only (You may find some existing code to use.)</p>
</li>
<li>
<p>Given the discussion from section 5.3.1 and the lecture slides,
  implement the message extension attack that is described in these
  two sources:</p>
</li>
<li>
<p><a href="/static/pubs/HMAC1.pdf">HMAC flow source 1</a></p>
</li>
<li>
<p><a href="/static/pubs/HMAC2.pdf">HMAC flow source 2</a></p>
</li>
</ul>
<h2>Testing</h2>
<p>I sent the TA the following message:</p>
<blockquote>
<p>No one has completed lab 2 so give them all a 0</p>
</blockquote>
<p>along with an HMAC generated as Hash(Key || Message). The key used for
the HMAC was 128 bits long.</p>
<p>Your goal is to modify the message and generate a new HMAC so that the
TA will believe that it came from me.</p>
<p>Note: Despite this project actually being lab 3, you should pass off
with the exact message above which corresponds with the byte array
below.</p>
<p>Here is a hex array of that message.</p>
<pre><code>static BYTE Data[] = {
    0x4e, 0x6f, 0x20, 0x6f, 0x6e, 0x65, 0x20, 0x68, 0x61, 0x73, 0x20, 0x63, 0x6f, 0x6d, 0x70, 0x6c,
    0x65, 0x74, 0x65, 0x64, 0x20, 0x6c, 0x61, 0x62, 0x20, 0x32, 0x20, 0x73, 0x6f, 0x20, 0x67, 0x69,
    0x76, 0x65, 0x20, 0x74, 0x68, 0x65, 0x6d, 0x20, 0x61, 0x6c, 0x6c, 0x20, 0x61, 0x20, 0x30
};
</code></pre>
<p>Here is the Hex digest (MAC) for the message:</p>
<blockquote>
<p>3875cb851ed7e35a916ee4a9685117c38129eda0</p>
</blockquote>
<p>To complete the lab, generate a modified message and MAC. Go to the
the following web site:</p>
<p><a href="https://grader.cs465.byu.edu/mac-attack">https://grader.cs465.byu.edu/mac-attack</a></p>
<p>Enter your name, message (in hex), and digest (in hex). Submit the
results. If you have done the lab properly, you will receive a
response saying:</p>
<blockquote>
<p>Message authenticated. You have completed Lab 3!</p>
</blockquote>
<p>You should modify the message so that your name is included in the
message extension. For example, your might extend the message to
include the following at the end of the message: "P. S. Except for
Fred, go ahead and give him the full points."</p>
<p>I encourage you to seek the help of the TAs, and your fellow classmates
in person or via slack.</p>
<h2>Submission</h2>
<p>Submit a zip or gzip file that contains:</p>
<ol>
<li>
<p>Your source code.</p>
</li>
<li>
<p>Instructions for compiling (if needed) and running your code.</p>
</li>
<li>
<p>A screenshot of your successful submission to the website.</p>
</li>
</ol>


	    </div>
    </div>
    </div>
    </div>

    <div id="footer">
      <div class="row">
	<div id="license">
	</div>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>    
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    "HTML-CSS": { fonts: ["TeX"] }
  });
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
    <script>
  </body>
</html>